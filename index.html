<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MC Control + Status</title>
    <style>
        :root {
            --bg: #0f172a; --card: #1e293b; --text: #f8fafc;
            --green: #22c55e; --red: #ef4444; --blue: #3b82f6;
        }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: var(--card); padding: 2rem; border-radius: 24px; width: 90%; max-width: 400px; text-align: center; box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        
        /* Индикатор статуса */
        .status-badge {
            display: inline-flex; align-items: center; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: bold; margin-bottom: 20px; border: 1px solid #334155;
        }
        .dot { height: 10px; width: 10px; border-radius: 50%; display: inline-block; margin-right: 8px; }
        .online-dot { background-color: var(--green); box-shadow: 0 0 10px var(--green); }
        .offline-dot { background-color: var(--red); }

        .btns { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px; }
        .btn { padding: 15px; border: none; border-radius: 12px; cursor: pointer; color: white; font-weight: bold; transition: 0.2s; }
        .btn:disabled { opacity: 0.4; }
        .btn-start { background: var(--green); }
        .btn-stop { background: var(--red); }
        input { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #334155; background: #0f172a; color: white; margin-top: 10px; box-sizing: border-box; }
        #log { margin-top: 20px; font-size: 0.9rem; color: #94a3b8; }
    </style>
</head>
<body>

<div class="container">
    <div id="badge" class="status-badge">
        <span id="dot" class="dot offline-dot"></span>
        <span id="status-text">OFFLINE</span>
    </div>
    
    <h1>MC Launcher</h1>
    <input type="password" id="pass" placeholder="Пароль доступа">

    <div class="btns">
        <button id="b1" class="btn btn-start" onclick="run('start')">ПУСК</button>
        <button id="b2" class="btn btn-stop" onclick="run('stop')">СТОП</button>
    </div>

    <div id="log">Ожидание команд...</div>
</div>

<script>
    // ЗАМЕНИ НА СВОЮ ССЫЛКУ ИЗ CLOUDFLARE
    const API_URL = 'https://dash-dim-herbal-arms.trycloudflare.com';

    document.getElementById('pass').value = localStorage.getItem('mc_key') || '';

    async function checkStatus() {
        try {
            const res = await fetch(`${API_URL}/status`);
            const data = await res.json();
            const dot = document.getElementById('dot');
            const text = document.getElementById('status-text');

            if (data.status === 'online') {
                dot.className = 'dot online-dot';
                text.innerText = 'ONLINE';
                text.style.color = '#22c55e';
            } else {
                dot.className = 'dot offline-dot';
                text.innerText = 'OFFLINE';
                text.style.color = '#ef4444';
            }
        } catch (e) {
            document.getElementById('status-text').innerText = 'НЕТ СВЯЗИ';
        }
    }

    async function run(cmd) {
        const pass = document.getElementById('pass').value;
        localStorage.setItem('mc_key', pass);
        
        try {
            const res = await fetch(`${API_URL}/${cmd}`, {
                method: 'POST',
                headers: { 'Authorization': pass }
            });
            const data = await res.json();
            document.getElementById('log').innerText = data.message;
        } catch (e) {
            document.getElementById('log').innerText = "Ошибка сети";
        }
    }

    // Проверять статус каждые 5 секунд
    setInterval(checkStatus, 5000);
    // И один раз при загрузке
    checkStatus();
</script>

</body>
</html>